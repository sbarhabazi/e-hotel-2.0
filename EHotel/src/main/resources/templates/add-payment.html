<!DOCTYPE html>
<!-- Template Thymeleaf pour le formulaire d'enregistrement d'un paiement -->
<!-- Accessible via GET /payment/add/{id} (affichage) et POST /payment/add/{id} (soumission) -->
<!-- {id} correspond à l'ID de la location (Rental) à laquelle ce paiement est associé -->
<!-- CORRECTION : la balise <head> était absente dans la version originale (meta/link hors de head) -->
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Enregistrer un paiement - E-Hotel</title>
    <!-- Feuille de style Bootstrap 5.3.3 chargée depuis le CDN jsDelivr -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          crossorigin="anonymous">
</head>
<body>
    <div class="container mt-5">
        <div class="text-center">
            <h1>Enregistrer un paiement</h1>
        </div>

        <!-- Formulaire lié au DTO AddPaymentDTO via th:object="${payment}" -->
        <!-- th:action : URL dynamique incluant l'ID de la location concernée -->
        <!-- Le contrôleur PaymentController.addPayment() traite la soumission -->
        <form action="#" th:action="@{/payment/add/{id}(id=${id})}" th:object="${payment}" method="post">
            <!-- Champ caché indispensable: conserve l'ID de location dans le POST -->
            <input type="hidden" th:field="*{idRental}">
            <div class="alert alert-danger" th:if="${#fields.hasErrors('idRental')}" th:errors="*{idRental}">Erreur</div>

            <!-- Champ : Montant du paiement (décimal, ex : "145.50") -->
            <div class="mb-3">
                <label for="amount" class="form-label">Montant</label>
                <input type="number" min="0.01" step="0.01" class="form-control" id="amount" th:field="*{amount}">
                <!-- Affiche le message d'erreur de validation si le montant est invalide -->
                <div class="alert alert-danger" th:if="${#fields.hasErrors('amount')}" th:errors="*{amount}">Erreur</div>
            </div>

            <!-- Champ : Date du paiement (type date HTML5, validé par @FutureOrPresent) -->
            <div class="mb-3">
                <label for="date" class="form-label">Date</label>
                <input type="date" class="form-control" id="date" th:field="*{paymentDate}">
                <div class="alert alert-danger" th:if="${#fields.hasErrors('paymentDate')}" th:errors="*{paymentDate}">Erreur</div>
            </div>

            <!-- Sélecteur : Méthode de paiement utilisée par le client -->
            <!-- Les valeurs sont stockées en anglais dans la base de données -->
            <div class="mb-3">
                <label for="paymentMethod" class="form-label">Méthode de paiement</label>
                <select class="form-control" id="paymentMethod" th:field="*{paymentMethod}">
                    <option value="Credit card">Carte de crédit</option>
                    <option value="Debit card">Carte de débit</option>
                    <option value="Cash">Espèces</option>
                    <option value="Check">Chèque</option>
                    <option value="Bank transfer">Virement bancaire</option>
                </select>
                <div class="alert alert-danger" th:if="${#fields.hasErrors('paymentMethod')}" th:errors="*{paymentMethod}">Erreur</div>
            </div>

            <!-- Sélecteur : Statut du paiement (Payé, En attente, Remboursé) -->
            <!-- "Paid" = paiement confirmé, "Pending" = en attente, "Refunded" = remboursé -->
            <div class="mb-3">
                <label for="paymentStatus" class="form-label">Statut du paiement</label>
                <select class="form-control" id="paymentStatus" th:field="*{paymentStatus}">
                    <option value="Paid">Payé</option>
                    <option value="Pending">En attente</option>
                    <option value="Refunded">Remboursé</option>
                </select>
                <div class="alert alert-danger" th:if="${#fields.hasErrors('paymentStatus')}" th:errors="*{paymentStatus}">Erreur</div>
            </div>

            <!-- Bouton de soumission : déclenche PaymentController.addPayment() -->
            <button type="submit" class="btn btn-primary">Enregistrer</button>
        </form>
    </div>
</body>
</html>
